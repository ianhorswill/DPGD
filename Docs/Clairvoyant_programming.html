
<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- generic metadata -->
	<title>Clairvoyant programming</title>
	<meta name="author" content="Ian Horswill">
	<meta name="description" content="An introduction to declarative programming with applications to vidoegames">
	<meta name="generator" content="Booker">

	<!-- seo helpers: generic, twitter, facebook/opengraph -->
	<meta itemprop="name" content="Clairvoyant programming">
	<meta name="twitter:title" content="Clairvoyant programming">
	<meta property="og:title" content="Clairvoyant programming" />
	<meta property="og:type" content="article" />
	<meta property="og:site_name" content="Declarative Programming for Game Designers" />
	
	<!-- stylesheets -->
	<!-- bootstrap needs to come first -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<!-- then our style sheet -->
	<link rel="stylesheet" href="site.css"> 

	<!-- sample fonts, please feel free to replace with your preferred ones -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat|Public+Sans:400,700&display=swap&subset=latin-ext"> 

	<!-- highlightjs is used for source code formatting inside <code> tags. feel free to remove it. -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/styles/atom-one-dark.min.css">
	<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
	<script src="step.min.js"></script>
	<script>hljs.highlightAll();</script>
	
	<!-- use MathJax for latex rendering -->
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

	<!-- Use mermaid to render diagrams -->
	<script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'dark' });
    </script>
</head>

<body>
<div class="container-fluid shadow header">
	<h1 style="text-align: right;">Incomplete draft: do not cite!</h1>

	<div class="container">
		<div class="col-10 col-md-8 header-contents">
				<a class="backgroundlink" href="Part_I.html"> Part I </a>
			<h1><a class="simplelink" href="index.html">Clairvoyant programming</a></h1>
		</div>
	</div>
</div>

	<!-- Make clicking On Step code pop up a step interpreter and copy the code into the clipboard -->
	<script>
	document.querySelector("body").addEventListener('click', function(e) {
		var element = e.target.closest('code');
		if(element !== null && element.classList.contains('language-Step')) {
			var interp = window.open("https://ianhorswill.github.io/WebStep", "step");
			var handler = function(e) { 
				console.log(e.data);
				interp.postMessage(element.textContent, "*");
				window.removeEventListener('message', handler);
			};
			window.addEventListener('message', handler);
		}
	}, false);
	</script>



<div class="container-fluid">
	<div class="row justify-content-center">
		<div class="col-md-7 index-contents">

			<div class="container shadow blog-contents">

<p>We'll now introduce a range of different declarative formalisms from grammars to logic programming to generative planners.  Most of the examples will use the <a href="https://github.com/ianhorswill/Step">Step</a> programming language, which is in some sense a generalization of all three.  The examples are easy to translate into other declarative languages such as <a href="https://en.wikipedia.org/wiki/prolog">prolog</a>.  However, Step has a gentler learning curve than Prolog and is specifically designed for games an interactive fiction.  If Prolog is a language for the Chess Club, Step is Prolog for the theater kids.</p>
<p>Step is open-source and written in C#.  It's easy to include in Unity or Godot projects.  And you can try it interactively in your browser by clicking on any of the Step code fragments in the following pages.  We'll teach you Step as we go along.</p>
<p>We'll begin by discussing generating text using <a href="Grammars.html">simple grammars</a>.  While grammars are technically a declarative formalism, generation using the kinds of simple grammars we'll begin with doesn't really show off the power of clairvoyant/non-deterministic languages because there are no wrong choices to make.</p>
<p>However, we'll then discuss <a href="Logic_programming.html">logic programming</a>, where the same language used for grammars can be thought of instead as doing logical reasoning.  This will allow us to make simple databases and to query them with almost no work.</p>
<p>Then we'll talk about how to join the two to make grammars that involve inference.</p>
<p>If you're new to programming, I'd suggest you skip to the next page at this point.  But experience programmers curious what a nondeterminism would look like in a conventional language, read on.</p>
<h2 id="choice-and-failure-technical">Choice and failure (technical)</h2>
<p>As we <a href="Part_I.html">discussed earlier</a>, an <code>if</code> statement combines two functions &ndash; specifying options for a choice and specifying how to decide between them.  This is inconvenient for problems involving delayed feedback.  Nondeterministic languages provide a way of breaking those functions apart, so that the decision information can come <em>after</em> the choice.  These are typically described in terms of <strong>choice</strong>, where the program guesses which option is best, and <strong>failure</strong>, which tells the system that a previous choice was incorrect.  It's the system's job to try different sequences of choices until it can find a way to run the program without failure.  But as a programmer, you think of the system as always guessing right.</p>
<p>Conceretely, we could make a nondeterministic version of C# (or C, C++, Python, etc.) by adding two new statements.  One, <code>choose</code> is basically a <code>switch</code> statement without a control variable:</p>
<pre><code class="language-C#">choose {
    option: // do something
    option: // do something else
}
</code></pre>
<p>Or we could instead add a <code>choose</code> expression that chooses and element of an array and returns it:</p>
<pre><code class="language-C#">var element = choose myArray;
</code></pre>
<p>The other statement we add is <code>fail</code>.  It tells the system that this execution path make an incorrect choice along the way, so the system should try a different one.  In the version of choose that selects an element of an array, we'll treat choosing from an array with no elements as failure.</p>
<p>Now the algorithm to find a node in a tree with some property <code>P</code> is then just:</p>
<pre><code class="language-C#">Node FindP(Node n) =&gt; P(n) ? n : FindP(choose n.Children);
</code></pre>
<p>In other words: &ldquo;if <code>n</code> is the node we're looking for return it, otherwise choose the right child and recurse on it.&rdquo;  We pretend it always chooses the correct child even though, under the hood, the implementation of clairvoyant choice would be doing a tree search.</p>
<p>This isn't the most impressive example; tree searches aren't difficult to write.  But as you will see in the coming pages, we can use clairvoyant choice to implement logical inference, parsers, planners, and natural language generators.</p>




			</div>

		</div>

		<div class="col-md-3">

<div class="container-fluid sidebar">
			<h5>Clairvoyant programming</h5>
			<ol>
					<li><a class="backgroundlink" href="Grammars.html" id="section_page_1"> Simple grammars </a> <br></li>
					<li><a class="backgroundlink" href="Logic_programming.html" id="section_page_2"> Simple logic programs </a> <br></li>
					<li><a class="backgroundlink" href="State.html" id="section_page_3"> State in clairvoyant programming </a> <br></li>
					<li><a class="backgroundlink" href="Grammars_with_logic_programming.html" id="section_page_4"> Augmenting grammars with logic programs </a> <br></li>
			</ol>
	<script>
		document.addEventListener('keyup', function(e) {
			if (e.key >= '1' && e.key <= '9') document.getElementById('section_page_'+e.key).click()
		}, false);
	</script>
	</p>
	<br>
	<h5>Navigation: (click or use arrow keys)</h5>
	<p>
			<a class="simplelink" id="NextPage" href="Grammars.html"><b>Next:</b> Simple grammars</a><br>
			<script>
				document.addEventListener('keyup', function(e) { if (e.key == 'ArrowRight' || e.key == "Return") document.getElementById('NextPage').click()}, false);
			</script>
			<a class="simplelink" id="PreviousPage" href="Advantages.html"><b>Previous:</b> Advantages</a><br>
			<script>
				document.addEventListener('keyup', function(e) { if (e.key == 'ArrowLeft') document.getElementById('PreviousPage').click()}, false);
			</script>
			<a class="simplelink" id="UpPage" href="Part_I.html"><b>Up:</b> Part I</a><br>
			<script>
				document.addEventListener('keyup', function(e) { if (e.key == 'ArrowUp') document.getElementById('UpPage').click()}, false);
			</script>
	</p>
</div>

		</div>
	</div>
</div>



<div class="container-fluid footer">
	<div class="container">
		<div class="row">
			<div class="col-10 col-lg-8 footer-contents">
				<div class="text-muted">
					<h4><a class="simplelink" href="index.html">Declarative Programming for Game Designers</a></h4>

					Copyright &copy; 2025 Ian Horswill
				</div>
				<div class="text-muted">
					<a href="https://github.com/rzubek/mies">Made by Booker, based on Rob Zubek's Mies (Crown Theme)</a>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	document.querySelectorAll('.language-step').forEach(e => {e.title = 'Click here to try the code'; });
</script>

<!-- this is required for bootstrap -->

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

</body>
</html>



