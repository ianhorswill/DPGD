
<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- generic metadata -->
	<title>A deeper magic: clairvoyance</title>
	<meta name="author" content="Ian Horswill">
	<meta name="description" content="An introduction to declarative programming with applications to vidoegames">
	<meta name="generator" content="Booker">

	<!-- seo helpers: generic, twitter, facebook/opengraph -->
	<meta itemprop="name" content="A deeper magic: clairvoyance">
	<meta name="twitter:title" content="A deeper magic: clairvoyance">
	<meta property="og:title" content="A deeper magic: clairvoyance" />
	<meta property="og:type" content="article" />
	<meta property="og:site_name" content="Declarative Programming for Game Designers" />
	
	<!-- stylesheets -->
	<!-- bootstrap needs to come first -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

	<!-- then our style sheet -->
	<link rel="stylesheet" href="site.css"> 

	<!-- sample fonts, please feel free to replace with your preferred ones -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat|Public+Sans:400,700&display=swap&subset=latin-ext"> 

	<!-- highlightjs is used for source code formatting inside <code> tags. feel free to remove it. -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/styles/atom-one-dark.min.css">
	<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
	<script src="step.min.js"></script>
	<script>hljs.highlightAll();</script>
	
	<!-- use MathJax for latex rendering -->
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

	<!-- Use mermaid to render diagrams -->
	<script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'dark' });
    </script>
</head>

<body>
<div class="container-fluid shadow header">
	<h1 style="text-align: right;">Incomplete draft: do not cite!</h1>

	<div class="container">
		<div class="col-10 col-md-8 header-contents">
				<a class="backgroundlink" href="Part_I.html"> Part I </a>
&nbsp;&#x25BB;&nbsp;				<a class="backgroundlink" href="Clairvoyant_programming.html"> Clairvoyant programming </a>
&nbsp;&#x25BB;&nbsp;				<a class="backgroundlink" href="Logic_programming.html"> Simple logic programs </a>
			<h1><a class="simplelink" href="index.html">A deeper magic: clairvoyance</a></h1>
		</div>
	</div>
</div>

	<!-- Make clicking On Step code pop up a step interpreter and copy the code into the clipboard -->
	<script>
	document.querySelector("body").addEventListener('click', function(e) {
		var element = e.target.closest('code');
		if(element !== null && element.classList.contains('language-Step')) {
			var interp = window.open("https://ianhorswill.github.io/WebStep", "step");
			var handler = function(e) { 
				console.log(e.data);
				interp.postMessage(element.textContent, "*");
				window.removeEventListener('message', handler);
			};
			window.addEventListener('message', handler);
		}
	}, false);
	</script>



<div class="container-fluid">
	<div class="row justify-content-center">
		<div class="col-md-7 index-contents">

			<div class="container shadow blog-contents">

<p>Again, here's our cats, dogs, and spies example:</p>
<pre><code class="language-step">[predicate]
Dog benji.
Dog lassie.

[predicate]
Cat morris.
Cat garfield.
Cat acoustic_kitty.

[predicate]
Animal ?x: [Dog ?x]
Animal ?x: [Cat ?x]

[predicate]
Human jason_bourne.

[predicate]
Spy acoustic_kitty.
Spy jason_bourne.
</code></pre>
<p>When we query <code>[Animal ?who] [Spy ?who]</code> it runs the <code>Animal</code> call, then the <code>Spy</code> call.  For the <code>Animal</code> call, it has its choice of two methods, one of which calls <code>Dog</code> and one of which runs <code>Cat</code>.  Each of those has a choice of two methods.  When one works, we then run <code>Spy</code>, which also has a choice of two methods.  So in the process of running the query, it makes a series of choices that form a tree:</p>
<pre class="mermaid">graph TB
    a("[Animal ?x]") -- "Animal ?x: [Dog ?x]" --> d("[Dog ?x]")
    style a fill:green
    style d fill:red
        d -- "Dog benji." --> benji("[Spy benji]")  -- "Spy acoustic_kitty." --> f1(fail)
        style benji fill:red
        style f1 fill:red
        benji  -- "Spy jason_bourne." --> f1a(fail)
        style f1a fill:red
        d -- "Dog lassie." --> lassie("[Spy lassie]") -- "Spy acoustic_kitty." --> f2(fail)
        style lassie fill:red
        style f2 fill:red
        lassie -- "Spy jason_bourne." --> f2a(fail)
        style f2a fill:red
    a("[Animal ?x]") -- "Animal ?x: [Cat ?x]" --> c("[Cat ?x]")
        c -- "Cat morris." --> morris("[Spy morris]")  -- "Spy acoustic_kitty." --> f3(fail)
        style morris fill:red
        style c fill:green
        style f3 fill:red
        morris -- "Spy jason_bourne." --> f3a(fail)
        style f3a fill:red
        c -- "Cat garfield." --> garfield("[Spy garfield]") -- "Spy acoustic_kitty." --> f4(fail)
        style garfield fill:red
        style f4 fill:red
        garfield -- "Spy jason_bourne." --> f4a(fail)
        style f4a fill:red
        c -- "Cat acoustic_kitty." --> ak("[Spy acoustic_kitty]") -- "Spy acoustic_kitty." --> s(success)
        style ak fill:green
        style s fill:green
        ak -- "Spy jason_bourne." --> f5(fail)
        style f5 fill:red
</pre>
<h2 id="the-laws-of-clairvoyance">The laws of clairvoyance</h2>
<p>Ultimately, this is what Alan Turing called a <em>choice machine</em>: it makes a series of choices that lead to other choices, and ultimately to success or failure.  In this case, the choices are which method to use for a given call, although we will look at other kinds of choices in other chapters.  What matters for the moment is that when making choices the system acts as if it <strong>always guesses right</strong>: it will always find a green path if there is one.</p>
<h3 id="fine-print-technical">Fine print (technical)</h3>
<p>Again, there's some find print.  Here's the version with the fine print:</p>
<ul>
<li><strong>Soundness</strong> if the program succeeds, it has taken a successful series of choices.</li>
<li><strong>Completeness</strong> if the tree of choices is finite and contains a successful sequence of choices, the system will make a successful sequence of choices; if not, if there is no successful sequence to find, the system will signal failure.</li>
</ul>
<p>There's also a little extra fine print, since in Step tasks can be <code>[randomized]</code> or not.  Your program can easily have multiple solutions (multiple green paths).  As we said, the query <code>[Animal ?]</code> has four different solutions.  If all your tasks are randomized, then you get a randomly chosen solution.  But if tasks aren't randomized, then it always gives you the <strong>leftmost</strong> solution in the tree.  That ends up being important when we get to recursion.</p>
<h2 id="nondeterminism-esoteric">Nondeterminism (esoteric)</h2>
<p>These days, the conventional term for this is <strong>nondeterminism</strong> and algorithms that make choices that are presumed always to be correct are called <strong>nondeterministic algorithms</strong>.  I don't love that term, partly because the word nondeterminism is used to mean many other things in computer science, all of which are very, very bad.  But also, it doesn't communicate the essential point of it: that it always guesses right when there is a right choice to guess.</p>




			</div>

		</div>

		<div class="col-md-3">

<div class="container-fluid sidebar">
			<h5>Simple logic programs</h5>
			<ol>
					<li><a class="backgroundlink" href="Predicates.html" id="section_page_1"> Predicates </a> <br></li>
					<li><a class="backgroundlink" href="Asking_questions.html" id="section_page_2"> Asking questions of predicates </a> <br></li>
					<li><a class="backgroundlink" href="Inference.html" id="section_page_3"> Inference </a> <br></li>
					<li><a class="backgroundlink" href="Magic.html" id="section_page_4"> Magic </a> <br></li>
					<li><a class="simplelink" href="Clairvoyance.html" id="section_page_5"> <b> A deeper magic: clairvoyance </b> </a> <br></li>
					<li><a class="backgroundlink" href="Under_the_hood.html" id="section_page_6"> Under the hood (technical) </a> <br></li>
			</ol>
	<script>
		document.addEventListener('keyup', function(e) {
			if (e.key >= '1' && e.key <= '9') document.getElementById('section_page_'+e.key).click()
		}, false);
	</script>
	</p>
	<br>
	<h5>Navigation: (click or use arrow keys)</h5>
	<p>
			<a class="simplelink" id="NextPage" href="Under_the_hood.html"><b>Next:</b> Under the hood (technical)</a><br>
			<script>
				document.addEventListener('keyup', function(e) { if (e.key == 'ArrowRight' || e.key == "Return") document.getElementById('NextPage').click()}, false);
			</script>
			<a class="simplelink" id="PreviousPage" href="Magic.html"><b>Previous:</b> Magic</a><br>
			<script>
				document.addEventListener('keyup', function(e) { if (e.key == 'ArrowLeft') document.getElementById('PreviousPage').click()}, false);
			</script>
			<a class="simplelink" id="UpPage" href="Logic_programming.html"><b>Up:</b> Simple logic programs</a><br>
			<script>
				document.addEventListener('keyup', function(e) { if (e.key == 'ArrowUp') document.getElementById('UpPage').click()}, false);
			</script>
	</p>
</div>

		</div>
	</div>
</div>



<div class="container-fluid footer">
	<div class="container">
		<div class="row">
			<div class="col-10 col-lg-8 footer-contents">
				<div class="text-muted">
					<h4><a class="simplelink" href="index.html">Declarative Programming for Game Designers</a></h4>

					Copyright &copy; 2025 Ian Horswill
				</div>
				<div class="text-muted">
					<a href="https://github.com/rzubek/mies">Made by Booker, based on Rob Zubek's Mies (Crown Theme)</a>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	document.querySelectorAll('.language-step').forEach(e => {e.title = 'Click here to try the code'; });
</script>

<!-- this is required for bootstrap -->

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

</body>
</html>



